/**
 * Set the body of "看護助手が辞めたいと思ったら？退職の選択肢とサービス比較"
 * to the latest curated content (Portable Text).
 *
 * Usage:
 *   SANITY_API_TOKEN=xxx node scripts/set-quit-retirement-article.js
 */

const { createClient } = require('next-sanity')
const { randomUUID } = require('crypto')

const slug = 'nursing-assistant-quit-retirement'
const projectId = process.env.NEXT_PUBLIC_SANITY_PROJECT_ID || '72m8vhy2'
const dataset = process.env.NEXT_PUBLIC_SANITY_DATASET || 'production'
const apiVersion = process.env.NEXT_PUBLIC_SANITY_API_VERSION || '2024-01-01'
const token = process.env.SANITY_API_TOKEN

if (!token) {
  console.error('Error: SANITY_API_TOKEN is not set.')
  process.exit(1)
}

const client = createClient({
  projectId,
  dataset,
  apiVersion,
  useCdn: false,
  token,
})

const k = () => randomUUID().replace(/-/g, '')
const block = (text, style = 'normal') => ({
  _type: 'block',
  _key: k(),
  style,
  markDefs: [],
  children: [{ _type: 'span', _key: k(), marks: [], text }],
})

// Content (text-only, headings via style)
const body = [
  block('イントロダクション', 'h2'),
  block('看護助手として「もう限界かも」と感じるのは珍しくありません。人手不足、夜勤続き、理不尽なやり取り。わたし自身も現場で同じ壁にぶつかり、体も心もすり減った経験があります。このしんどさは、あなた一人のせいではなく、現場の構造的な負荷が重なっているからです。まずは自分を責めず、「どう動けば安全で後悔の少ない道を選べるか」を一緒に整理しましょう。'),

  block('看護助手が辞めたいと感じるリアルな理由', 'h2'),
  block('給料が上がりにくく、責任や業務量に見合わないと感じること。人手不足で休憩も削られ、感謝より「もっとやって」が多い現場。コミュニケーションのすれ違いで心が削られ、腰や膝の痛みが蓄積し、夜勤で生活リズムが壊れていく。どれもよくある悩みで、あなたが弱いわけではありません。まずは「つらい」と口に出していいと受け止めてください。'),

  block('退職を考えたらまずやるべき準備', 'h2'),
  block('退職理由の整理：本音（負担、賃金、人間関係）と、伝える建前（家庭都合、キャリア見直し）を切り分けておくと話しやすくなります。'),
  block('有給残日数の確認と消化計画：退職日から逆算して、早めに申請するスケジュールをメモに。'),
  block('給与締め日、保険、離職票の確認：月末締めか、社保切替・雇用保険手続きのスケジュールを把握しておくと安心です。'),
  block('トラブル防止メモ：上司とのやり取り、引き継ぎ内容、シフト調整を簡単に記録しておくと交渉の根拠になります。'),
  block('信頼できる人に相談：同僚、家族、労組、専門窓口。感情の整理と第三者の視点があるだけで、決断の重さが少し軽くなります。'),

  block('看護助手が取れる3つの退職方法', 'h2'),
  block('自分で退職を伝える', 'h3'),
  block('費用ゼロで進められます。職場との関係が極端に悪くなく、交渉に慣れている人向け。引き継ぎを自分で段取りできる余力があるなら、もっともシンプルです。'),
  block('退職代行サービスを利用する', 'h3'),
  block('連絡や交渉を任せられます。上司と話すのが怖い、ハラスメントがある、即日で職場を離れたい場合に有効です。弁護士・労組運営を選べば法的にも安心度が高くなります。'),
  block('サポートを受けながら自分で伝える（セルフ退職）', 'h3'),
  block('テンプレや相談を受けつつ、自分名義で進める方法。コストを抑えたいが手順に不安がある人向けです。メッセージ文例が欲しいときにも有効です。'),
  block('比較の目安', 'h3'),
  block('・自分で伝える: 0円 / 即日性△ / 法的安心度△'),
  block('・退職代行: 数万円 / 即日性◎ / 法的安心度○〜◎（弁護士・労組なら◎）'),
  block('・セルフ退職: 低〜中コスト / 即日性○（テンプレ依存） / 安心度△〜○'),
  block('それぞれの方法で「いまの自分にとって何が一番ラクか」を基準に選んで大丈夫です。'),

  block('自分で退職を伝える場合のポイント', 'h2'),
  block('・伝え方テンプレ：「家庭の事情で○月末に退職を希望します。引き継ぎは文書で準備しますので、日程をご相談させてください。」'),
  block('・本音を建前に変える：人手不足→家庭都合・キャリア見直し、賃金不満→別分野で経験を積みたい。'),
  block('・引き止め回避：退職日は確定ベースで伝え、延長は難しいと先に言う。引き継ぎ内容と期限をセットで提示し、感情論ではなくスケジュールで会話する。'),
  block('・スケジュール：意思表明→退職日確定→引き継ぎ→有給消化→離職票・証明書の受領。無理せず少しずつ進める。'),

  block('退職代行サービスの安全性と選び方', 'h2'),
  block('弁護士／労働組合を推奨：法的交渉や書類対応を適法に行えるため、未払賃金や有休消化の交渉も安心度が上がります。'),
  block('非弁業者のリスク：不当請求、手続き不備、トラブル時に対応できない可能性があります。合法運営か、実績と口コミを必ず確認。'),
  block('医療現場で起こりがちなトラブル：有休消化の交渉がうまくいかない、退職書類が遅れる、引き継ぎ拒否を理由に退職を渋られる、など。'),
  block('進行イメージ：無料相談→申込・支払い→会社連絡（代行）→退職意思伝達→書類・精算確認→完了。流れを知るだけでも不安は軽くなります。'),

  block('安心して利用できる退職代行サービス比較（3社）', 'h2'),
  block('弁護士法人みやび（法的安心・全国対応）', 'h3'),
  block('弁護士が直接対応し、未払賃金やハラスメント交渉も相談可。医療・介護の実績が多く、書類や有休消化にも配慮。'),
  block('退職代行 即ヤメ（スピード・24時間相談）', 'h3'),
  block('LINEで24時間相談でき、即日退職を目指しやすい。連絡を自分で取りたくない人、夜間相談したい人向け。'),
  block('弁護士法人ガイア法律事務所（医療介護の相談実績）', 'h3'),
  block('医療・介護案件の経験が多く、就業規則や引き継ぎ手順にも配慮。LINE/メール相談で進めやすい。'),
  block('推奨理由（公平・中立）', 'h3'),
  block('非弁リスクを避け、医療介護の相談実績と即日性・安心度を基準に3社を掲載。どれが自分に合うか、特徴から選びましょう。'),

  block('看護助手の退職後に必要な手続きまとめ', 'h2'),
  block('・健康保険の切り替え（国保 or 扶養）'),
  block('・雇用保険（失業給付）の手続き'),
  block('・退職証明書・源泉徴収票の受け取り'),
  block('・再就職・キャリアパス：介護職、医療事務、准看護師・看護師へのステップアップなど'),
  block('・資格取得の道筋：初任者研修、実務者研修、医療事務系資格'),

  block('よくある質問（FAQ）', 'h2'),
  block('Q: 即日退職はできる？ A: 代行を使えば可能性が高い。弁護士・労組系が安心。'),
  block('Q: 夜勤中でも辞められる？ A: 原則シフト調整後が望ましいが、体調や安全次第では早めに相談を。'),
  block('Q: 有給は使える？ A: 未消化分は取得を主張できる。退職日から逆算して計画的に申請を。'),
  block('Q: 退職後の職場の反応は？ A: 手続きが適法に済めば過度に気にしなくてOK。'),
  block('Q: トラブルが起きたら？ A: 記録を残し、弁護士・労組・信頼できる代行へ相談。非弁業者は避ける。'),

  block('まとめ：あなたの人生が最優先です', 'h2'),
  block('「辞めてもいい」「限界なら逃げてもいい」。あなたの健康と人生が最優先です。無料相談も活用し、無理をせず次の一歩へ進んでください。安心して退職するための選択肢は、必ずあります。')
]

async function main() {
  const doc = await client.fetch(
    `*[_type == "post" && slug.current == $slug][0]{_id}`,
    { slug }
  )
  if (!doc?._id) {
    console.error('Post not found for slug:', slug)
    process.exit(1)
  }

  await client
    .patch(doc._id)
    .set({ body })
    .commit({ autoGenerateArrayKeys: false })

  console.log(`✅ Updated body for ${slug}`)
}

main().catch(err => {
  console.error(err)
  process.exit(1)
})
