# 品質保証・セキュリティ監査タスク

## 監査概要
本タスクは、現在開発中のプロダクトのリリース前に必要な技術的要件を包括的に確認するものです。OWASP、W3C、WCAG等の国際標準に基づき、セキュリティ、パフォーマンス、アクセシビリティ、法的要件を網羅的に検証してください。ただし、現在開発中のプロダクトに関係しない部分は実装など不要です。関係のない項目はスキップしてください。

## 1. セッション・認証セキュリティ監査

### 1.1 Cookie設定の検証
**確認項目：**
- HTTPSでのみ送信される設定の確認
- クロスサイトリクエスト防止設定の検証
- JavaScriptからのアクセス制限設定
- ドメインスコープの適切性確認
- セキュアプレフィックスの活用検討

**リスク評価基準：**
- サブドメイン間でのセキュリティリスク
- セッションハイジャックの可能性
- XSS攻撃への耐性

### 1.2 認証フローの安全性
**確認項目：**
- ログイン機能はあるのかないのかを確認
- ログイン機能がなければ、本項目は不要と判断
- アカウント列挙攻撃への対策
- 複数認証方式の統合ロジック
- 重要操作時の再認証要求
- アカウント設定変更の保護

## 2. 入力検証・出力制御

### 2.1 包括的入力検証
**実装要件：**
- サーバーサイド検証の必須化
- URLスキーム検証（危険なプロトコルの除外）
- 正規表現バイパスの防止
- パスパラメータの安全性確保

**特別な考慮事項：**
- 予約語との衝突回避
- システムパスとの競合防止
- 特殊文字の適切な処理

### 2.2 出力エンコーディング
**必須対策：**
- HTMLコンテキストでのエスケープ
- JavaScriptコンテキストでの処理
- URLコンテキストでのエンコード
- SQLクエリのパラメータ化

## 3. HTTPセキュリティヘッダー

### 3.1 必須セキュリティヘッダー
**実装すべきヘッダー：**
- 厳格な転送セキュリティ（HSTS）
- コンテンツタイプ検証
- フレーム埋め込み制御
- コンテンツセキュリティポリシー（CSP）

### 3.2 レスポンス保護
**確認事項：**
- ユーザー入力のヘッダー注入防止
- エラー情報の適切なマスキング
- キャッシュ制御の適切性

## 4. データアクセス制御

### 4.1 認可メカニズム
**検証項目：**
- 水平権限昇格の防止
- 垂直権限昇格の防止
- 一括更新・削除の安全性
- オブジェクトレベルの認可

### 4.2 ストレージセキュリティ
**確認事項：**
- オブジェクトストレージの公開設定
- ディレクトリリスティングの無効化
- バックアップの暗号化
- アクセスログの記録

## 5. リダイレクト・外部統合

### 5.1 安全なリダイレクト
**実装要件：**
- オープンリダイレクトの防止
- ホワイトリスト方式の採用
- 相対URLの使用推奨

### 5.2 ファイルアップロード
**セキュリティ要件：**
- ファイルタイプ検証
- サイズ制限の実装
- ファイル名のサニタイズ
- 実行権限の制御

## 6. メール送信セキュリティ

### 6.1 スパム・悪用防止
**対策項目：**
- ユーザー入力のサニタイズ
- 送信レート制限
- 重複送信防止メカニズム
- バッチ処理の冪等性確保

### 6.2 送信者認証
**必須設定：**
- SPFレコード設定
- DKIM署名実装
- DMARCポリシー設定
- 配信停止機能の実装

## 7. 検索エンジン最適化（SEO）

### 7.1 基本的なSEO要件
**実装項目：**
- 適切なタイトルタグ
- メタディスクリプション
- 正規URL（canonical）設定
- 構造化データマークアップ

### 7.2 インデックス制御
**確認事項：**
- エラーページの非インデックス化
- 検索結果ページの処理
- 開発環境の非公開設定
- XMLサイトマップの生成

## 8. ソーシャルメディア対応

### 8.1 OGP実装
**必須メタデータ：**
- タイトル、説明、画像
- URL情報
- サイト名
- プラットフォーム別カード設定

## 9. 決済システムセキュリティ

### 9.1 トランザクション整合性
**確認項目：**
- 冪等性の確保
- 二重課金防止
- 失敗時のロールバック
- 監査ログの実装

### 9.2 コンプライアンス
**要件：**
- PCI DSS準拠（該当する場合）
- 返金ポリシーの明示
- 自動更新の適切な処理
- インボイス制度対応

## 10. アクセシビリティ要件

### 10.1 WCAG 2.1準拠
**最低要件：**
- 画像の代替テキスト
- キーボードナビゲーション
- スクリーンリーダー対応
- 色のコントラスト比

### 10.2 インタラクティブ要素
**実装事項：**
- フォーカス管理
- ARIAラベルの適切な使用
- エラーメッセージの明確化

## 11. パフォーマンス最適化

### 11.1 フロントエンド最適化
**確認項目：**
- バンドルサイズの最適化
- 画像の遅延読み込み
- 適切な画像フォーマット
- レイアウトシフトの防止

### 11.2 バックエンド最適化
**実装事項：**
- データベースインデックス
- キャッシュ戦略
- CDN活用
- 静的アセットの最適化

## 12. クロスプラットフォーム対応

### 12.1 レスポンシブデザイン
**テスト項目：**
- モバイルデバイス対応
- タブレット表示
- デスクトップ表示
- 横向き・縦向き対応

### 12.2 ブラウザ互換性
**確認環境：**
- 主要ブラウザでの動作
- フォント表示の一貫性
- スクロールバー表示の考慮
- 長文テキストの処理

## 13. プライバシー・法的要件

### 13.1 データ保護
**考慮事項：**
- クライアントサイドストレージの制限
- サードパーティCookie依存の回避
- ITP（Intelligent Tracking Prevention）対応

### 13.2 規制対応
**確認項目：**
- 個人情報保護法準拠
- GDPR対応（該当する場合）
- 電気通信事業法（該当する場合）
- 適切な言語設定

## 14. 法的文書の整備【重要】

### 14.1 利用規約
**確認項目：**
- [ ] サービス内容の正確な記載
- [ ] 禁止事項の明確化
- [ ] 免責事項の適切な設定
- [ ] 準拠法・管轄裁判所の指定
- [ ] 最新の法改正への対応

### 14.2 プライバシーポリシー
**必須記載事項：**
- [ ] 収集する個人情報の種類
- [ ] 利用目的の明示
- [ ] 第三者提供の有無と条件
- [ ] Cookie使用に関する説明
- [ ] データ保持期間
- [ ] ユーザーの権利（開示・訂正・削除請求）

### 14.3 特定商取引法に基づく表記
**ECサイト・有料サービスの場合：**
- [ ] 事業者名・代表者名
- [ ] 所在地
- [ ] 連絡先
- [ ] 販売価格・送料
- [ ] 支払方法・時期
- [ ] 商品引渡し時期
- [ ] 返品・交換の条件

### 14.4 最終法務チェック
**実行すべきプロンプト：**
このプロダクトを公開する上で、利用規約やプライバシーポリシーは書きましたが、他にも注意すべき日本の法律や、関連する利用規約があれば深く考えて分析し、全てリストアップし、教えてください。まずは実行はせずに、対策が必要に思えるものをリストアップするだけにしてください。

**追加で確認すべき法的事項：**
- [ ] 著作権法（コンテンツ利用）
- [ ] 商標法（ブランド名・ロゴ）
- [ ] 不正競争防止法
- [ ] 景品表示法（広告・表示）
- [ ] 資金決済法（ポイント・前払い）
- [ ] 薬機法（健康・美容関連）
- [ ] 金融商品取引法（投資関連）

## 15. 運用準備

### 15.1 エラーハンドリング
**実装要件：**
- エラー通知システム
- ユーザーフレンドリーなエラーページ
- ログ記録の適切性

### 15.2 基本設定
**確認項目：**
- ファビコン設定
- モバイルアイコン設定
- アナリティクス実装
- 多言語対応（該当する場合）

### 15.3 インフラセキュリティ
**必須項目：**
- 定期バックアップ設定
- 二要素認証の有効化
- アクセス制御の実装
- 監査ログの保持

## 16. ブランド保護

**確認事項：**
- サービス名の国際的な意味確認
- 商標調査
- ドメイン名の適切性

## 報告書作成要件

各項目について以下を記載：
1. **現状評価**（適合/不適合/該当なし）
2. **リスクレベル**（Critical/High/Medium/Low）
3. **改善提案**
4. **実装優先度**
5. **参照すべき標準規格・法令**

## リリース前最終チェックリスト

### 技術面
- [ ] すべてのセキュリティ項目をクリア
- [ ] パフォーマンステスト完了
- [ ] クロスブラウザテスト完了
- [ ] モバイル対応確認

### 法務面
- [ ] 利用規約の最終確認
- [ ] プライバシーポリシーの最終確認
- [ ] 特商法表記の確認（該当する場合）
- [ ] その他必要な法的文書の整備
- [ ] 法務チェックプロンプトの実行と対応

監査完了後、発見された問題の修正計画を優先度順に策定し、まずは私に報告するために報告書のファイルを作成しまとめてください。
私が実装する必要があるかどうかまず判断します。
その後、必要アリと判断されたものは実装していってください。